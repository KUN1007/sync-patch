model patch_char {
  id                   Int      @id @default(autoincrement())
  image                String   @default("")  @db.VarChar(1007)
  gender               String   @default("unknown")
  // roles from providers, e.g. voice / scenario / artist
  roles                String[]
  // protagonist role for this VN: protagonist/main/side/appears
  role                 String   @default("side")
  // extra attributes
  birthday             String   @default("")
  bust                 Int      @default(0)
  waist                Int      @default(0)
  hips                 Int      @default(0)
  height               Int      @default(0)
  weight               Int      @default(0)
  cup                  String   @default("")
  age                  Int      @default(0)
  infobox String @default("")

  vndb_char_id         String?  @db.VarChar(32)
  bangumi_character_id Int?

  name_zh_cn           String   @default("") @db.VarChar(1007)
  name_ja_jp           String   @default("") @db.VarChar(1007)
  name_en_us           String   @default("") @db.VarChar(1007)

  description_zh_cn    String @default("")  @db.VarChar(100007)
  description_ja_jp    String @default("")  @db.VarChar(100007)
  description_en_us    String @default("")  @db.VarChar(100007)



  alias patch_char_alias[]
  voices  patch_char_person_relation[]
  patches patch_char_relation[]

  @@unique([vndb_char_id])
  @@unique([bangumi_character_id])

  created              DateTime @default(now())
  updated              DateTime @updatedAt
}

model patch_char_alias {
  id            Int        @id @default(autoincrement())
  name          String     @db.VarChar(233)
  patch_char_id Int
  char          patch_char @relation(fields: [patch_char_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  created DateTime @default(now())
  updated DateTime @updatedAt

  @@index([patch_char_id])
  @@index([name])
  @@unique([patch_char_id, name])
}

model patch_char_person_relation {
  id             Int         @id @default(autoincrement())
  patch_char_id  Int
  patch_person_id Int
  relation       String      @default("")

  char   patch_char  @relation(fields: [patch_char_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  person patch_person @relation(fields: [patch_person_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  created DateTime @default(now())
  updated DateTime @updatedAt

  @@unique([patch_char_id, patch_person_id, relation])
  @@index([patch_char_id])
  @@index([patch_person_id])
}

model patch_char_relation {
  id            Int        @id @default(autoincrement())
  patch_id      Int
  patch_char_id Int

  patch patch      @relation(fields: [patch_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  char  patch_char @relation(fields: [patch_char_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  created DateTime @default(now())
  updated DateTime @updatedAt

  @@unique([patch_id, patch_char_id])
  @@index([patch_id])
  @@index([patch_char_id])
}
